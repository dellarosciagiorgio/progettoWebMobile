import{t as c,a as v}from"../chunks/C3LzQ5sL.js";import"../chunks/Cf1npzb8.js";import{h as re,k as Ce,p as Pe,s as b,af as Be,ag as xe,a6 as j,a3 as p,a as De,m as G,a0 as s,a1 as u,e as k,a2 as l,o as z,n as de}from"../chunks/TWVgqK11.js";import{i as E,e as J,s as K}from"../chunks/BZQWxGEs.js";import{a as Fe}from"../chunks/Bu93Vllf.js";import{i as Te}from"../chunks/B6UNWQNk.js";import{s as Ne,a as ae}from"../chunks/DC1nVi2p.js";import{s as Ve}from"../chunks/DPXuhX4k.js";import{o as qe}from"../chunks/8FTZ2a1S.js";/* empty css                */import{r as D,i as F,u as T}from"../chunks/Bm-Gevi7.js";import{g as N,s as te,d as ie}from"../chunks/hqmt8S-F.js";const Ue=!0;function We(o,y,S,B,g){var m;re&&Ce();var i=(m=y.$$slots)==null?void 0:m[S],w=!1;i===!0&&(i=y.children,w=!0),i===void 0||i(o,w?()=>B:B)}function M(o,y,S,B,g,i){var w=o.__className;if(re||w!==S||w===void 0){var m=Fe(S,B,i);(!re||m!==o.getAttribute("class"))&&(m==null?o.removeAttribute("class"):o.className=m),o.__className=S}else if(i&&g!==i)for(var H in i){var L=!!i[H];(g==null||L!==!!g[H])&&o.classList.toggle(H,L)}return i}const ge=Ue,je=()=>{const o=Ve;return{page:{subscribe:o.page.subscribe},navigating:{subscribe:o.navigating.subscribe},updated:o.updated}},Ge={subscribe(o){return je().page.subscribe(o)}};var Je=c('<div class="custom-dropdown"><a href="/Eventi/EventiFuturi" class="dropdown-item">Eventi Futuri</a> <a href="/Eventi/EventiPassati" class="dropdown-item">Eventi Passati</a></div>'),Ke=c('<a href="/Biglietto">I miei biglietti</a>'),Qe=c('<div class="nav-link-dropdown"><!></div> <a href="/Sagre">Sagre</a> <!>',1),Xe=c('<a href="/LeMieSagre">Le mie sagre</a>'),Ye=c('<a href="/LeMieSagre" class="dropdown-item">Le mie sagre</a>'),Ze=c('<a href="/Biglietto" class="dropdown-item">I miei biglietti</a>'),$e=c('<div class="custom-dropdown profile-menu"><div class="user-email"> </div> <!> <button class="dropdown-item logout-btn">Logout</button></div>'),ea=c('<div class="profile-dropdown"><div class="profile-icon"> </div> <!></div>'),aa=c('<a href="/LogIn" class="btn btn-login me-2">Login</a> <a href="/Registrazione" class="btn btn-register">Registrazione</a>',1),ta=c('<li class="mobile-nav-item"><a href="/Biglietto">I miei biglietti</a></li>'),ia=c('<li class="mobile-nav-item nested-item"><a href="/Eventi/EventiFuturi" class="mobile-nav-link">Eventi Futuri</a></li> <li class="mobile-nav-item nested-item"><a href="/Eventi/EventiPassati" class="mobile-nav-link">Eventi Passati</a></li> <li class="mobile-nav-item"><a href="/Sagre">Sagre</a></li> <!>',1),ra=c('<li class="mobile-nav-item"><a href="/LeMieSagre">Le mie sagre</a></li>'),sa=c('<li class="mobile-user-email"> </li> <li class="mobile-nav-item"><button class="mobile-nav-link mobile-logout-btn">Logout</button></li>',1),la=c('<li class="mobile-nav-item"><a class="mobile-nav-link" href="/LogIn">Login</a></li> <li class="mobile-nav-item"><a class="mobile-nav-link mobile-register" href="/Registrazione">Registrazione</a></li>',1),oa=c('<div class="mobile-menu"><ul class="mobile-nav"><li class="mobile-nav-item"><a href="/Home">Home</a></li> <!> <hr> <!></ul></div>'),na=c('<div class="navbar-wrapper"><nav class="navbar"><a class="navbar-brand" href="/Home"><img src="/logo.png" alt="Logo" width="28" height="28" class="me-2"> <span class="brand-text">Village Festival</span></a> <div class="main-nav d-none d-lg-flex"><div class="nav-links-center"><a href="/Home">Home</a> <!></div></div> <div class="auth-section d-none d-lg-flex"><!></div> <button class="menu-button d-lg-none"> </button> <!></nav></div> <!>',1);function Ea(o,y){Pe(y,!1);const[S,B]=Ne(),g=()=>ae(F,"$isAuthenticated",S),i=()=>ae(Ge,"$page",S),w=()=>ae(T,"$userEmail",S);let m=G(""),H=G(!1),L=G(!1);function _e(){b(L,!k(L)),k(L)&&(b(H,!1),b(V,!1))}function be(){b(H,!1)}const se=()=>{{const e=N("authToken"),a=N("userEmail"),t=N("userRole");return e&&a?(F.set(!0),T.set(a),t&&(D.set(t),b(m,t)),localStorage.setItem("authStatus","true"),localStorage.setItem("userEmail",a),t&&localStorage.setItem("userRole",t),!0):(F.set(!1),T.set(""),D.set(""),b(m,""),!1)}},Q=()=>{if(g()){const e=N("authToken"),a=N("userEmail"),t=N("userRole");e&&te("authToken",e),a&&te("userEmail",a),t&&te("userRole",t)}},le=()=>{ie("authToken"),ie("userEmail"),ie("userRole"),F.set(!1),T.set(""),D.set(""),b(m,""),localStorage.removeItem("authStatus"),localStorage.removeItem("userEmail"),localStorage.removeItem("userRole"),window.location.href="/Home"};let V=G(!1);function pe(e){e.stopPropagation(),b(V,!k(V))}function he(){b(V,!1)}function oe(e){!e.target.closest(".eventi-dropdown")&&!e.target.closest(".eventi-link")&&be(),!e.target.closest(".profile-dropdown")&&!e.target.closest(".profile-icon")&&he(),!e.target.closest(".mobile-menu")&&!e.target.closest(".menu-button")&&b(L,!1)}D.subscribe(e=>{b(m,e)}),qe(()=>{{document.addEventListener("click",oe),se()&&Q(),window.addEventListener("storage",a=>{(a.key==="authStatus"||a.key==="userEmail"||a.key==="userRole")&&(a.key==="authStatus"&&a.newValue==="true"?(F.set(!0),localStorage.getItem("userEmail")&&T.set(localStorage.getItem("userEmail")),localStorage.getItem("userRole")&&D.set(localStorage.getItem("userRole"))):a.key==="authStatus"&&!a.newValue&&(F.set(!1),T.set(""),D.set("")))});const e=setInterval(()=>{g()&&Q()},3e5);return()=>{document.removeEventListener("click",oe),clearInterval(e)}}}),Be(()=>(i(),ge),()=>{i()&&ge&&(se(),Q())}),xe(),Te();var ne=na(),X=j(ne),ve=s(X),Y=u(s(ve),2),ue=s(Y),ce=s(ue);let me;var ke=u(ce,2);{var Ee=e=>{var a=Qe(),t=j(a),I=s(t);{var q=f=>{var R=Je();v(f,R)};E(I,f=>{k(H)&&f(q)})}l(t);var O=u(t,2);let _;var A=u(O,2);{var C=f=>{var R=Ke();let x;p(r=>x=M(R,1,"nav-link",null,x,r),[()=>({active:i().url.pathname==="/Biglietto"})],z),v(f,R)};E(A,f=>{g()&&f(C)})}p(f=>_=M(O,1,"nav-link",null,_,f),[()=>({active:i().url.pathname==="/Sagre"})],z),v(e,a)},Se=e=>{var a=Xe();let t;p(I=>t=M(a,1,"nav-link",null,t,I),[()=>({active:i().url.pathname==="/LeMieSagre"})],z),v(e,a)};E(ke,e=>{k(m)!=="Organizzatore"?e(Ee):e(Se,!1)})}l(ue),l(Y);var Z=u(Y,2),we=s(Z);{var Le=e=>{var a=ea(),t=s(a),I=s(t,!0);l(t);var q=u(t,2);{var O=_=>{var A=$e(),C=s(A),f=s(C,!0);l(C);var R=u(C,2);{var x=n=>{var h=Ye();v(n,h)},r=n=>{var h=Ze();v(n,h)};E(R,n=>{k(m)==="Organizzatore"?n(x):n(r,!1)})}var d=u(R,2);l(A),p(()=>K(f,w())),J("click",d,le),v(_,A)};E(q,_=>{k(V)&&_(O)})}l(a),p(_=>K(I,_),[()=>w()[0].toUpperCase()],z),J("click",t,pe),v(e,a)},Ie=e=>{var a=aa();de(2),v(e,a)};E(we,e=>{g()?e(Le):e(Ie,!1)})}l(Z);var W=u(Z,2),Re=s(W,!0);l(W);var ze=u(W,2);{var Me=e=>{var a=oa(),t=s(a),I=s(t),q=s(I);let O;l(I);var _=u(I,2);{var A=r=>{var d=ia(),n=u(j(d),4),h=s(n);let P;l(n);var $=u(n,2);{var He=U=>{var ee=ta(),Oe=s(ee);let fe;l(ee),p(Ae=>fe=M(Oe,1,"mobile-nav-link",null,fe,Ae),[()=>({active:i().url.pathname==="/Biglietto"})],z),v(U,ee)};E($,U=>{g()&&U(He)})}p(U=>P=M(h,1,"mobile-nav-link",null,P,U),[()=>({active:i().url.pathname==="/Sagre"})],z),v(r,d)},C=r=>{var d=ra(),n=s(d);let h;l(d),p(P=>h=M(n,1,"mobile-nav-link",null,h,P),[()=>({active:i().url.pathname==="/LeMieSagre"})],z),v(r,d)};E(_,r=>{k(m)!=="Organizzatore"?r(A):r(C,!1)})}var f=u(_,4);{var R=r=>{var d=sa(),n=j(d),h=s(n,!0);l(n);var P=u(n,2),$=s(P);l(P),p(()=>K(h,w())),J("click",$,le),v(r,d)},x=r=>{var d=la();de(2),v(r,d)};E(f,r=>{g()?r(R):r(x,!1)})}l(t),l(a),p(r=>O=M(q,1,"mobile-nav-link",null,O,r),[()=>({active:i().url.pathname==="/Home"})],z),v(e,a)};E(ze,e=>{k(L)&&e(Me)})}l(ve),l(X);var ye=u(X,2);We(ye,y,"default",{}),p(e=>{me=M(ce,1,"nav-link",null,me,e),K(Re,k(L)?"Chiudi":"Menu")},[()=>({active:i().url.pathname==="/Home"})],z),J("click",W,_e),v(o,ne),De(),B()}export{Ea as component};
